<!DOCTYPE html>
<html>
<head><title>📈 Season Standings</title><link rel="stylesheet" href="style.css"></head>
<body>
<h1>📈 Season Tracker</h1>
<p><strong>Record:</strong> <span id="record">Loading...</span></p>
<p><strong>Power Ranking:</strong> <span id="ranking">Calculating...</span></p>
<table border="1" cellpadding="6" style="width:100%;margin-top:1rem;">
  <thead>
    <tr><th>Week</th><th>Result</th><th>Fan Approval</th><th>Chemistry</th></tr>
  </thead>
  <tbody id="logTable"></tbody>
</table>
<div class="nav"><a href="index.html">⬅️ Main Menu</a></div>
<script>
const gameState = JSON.parse(localStorage.getItem("basketballGM")) || {};
gameState.seasonLog = gameState.seasonLog || [];
const table = document.getElementById("logTable");

function updateSeasonLog() {
  const record = `W ${gameState.wins || 0} - L ${gameState.losses || 0}`;
  document.getElementById("record").textContent = record;

  const approval = gameState.fans?.approval || 50;
  const moraleScores = { "Icon": 5, "Leader": 4, "Neutral": 3, "Shocked": 2, "Unsettled": 1 };
  const moraleSum = (gameState.roster || []).reduce((sum, p) => sum + (moraleScores[p.morale] || 3), 0);
  const chemistry = Math.round((moraleSum / ((gameState.roster?.length || 1) * 5)) * 100);

  const powerScore = (gameState.wins || 0) * 4 + chemistry + approval;
  const rank = powerScore >= 180 ? "🏆 #1 Contender" :
               powerScore >= 150 ? "🔥 Top 5 Team" :
               powerScore >= 120 ? "💪 Playoff Hopeful" :
               powerScore >= 90 ? "😬 Bubble Watch" : "📉 Rebuilding";

  document.getElementById("ranking").innerHTML = `<strong>${rank}</strong>`;

  table.innerHTML = "";
  gameState.seasonLog.slice(-12).forEach((g, i) => {
    const row = document.createElement("tr");
    row.innerHTML = `<td>Week ${i + 1}</td><td>${g.result}</td><td>${g.approval}%</td><td>${g.chemistry}%</td>`;
    table.appendChild(row);
  });
}

updateSeasonLog();
</script>
</body>
</html>
